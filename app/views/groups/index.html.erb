<%= render 'shared/header' %>

<h1>Groups</h1>

<%= form_tag(groups_path, method: :get) do %>
  <p> Search for a group </p>
  <%= text_field_tag(:search, params[:search]) %>
  <%= submit_tag ("Search") %>
<% end %>

<table class="listing" summary="Group list" style="width: 100%;">
  <tr class="header">
    <th><%= link_to "Name", { sort: 'name', direction: (params[:sort] == 'name' && params[:direction] == 'asc') ? 'desc' : 'asc' } %></th>
    <th><%= link_to "Organization Type", { sort: 'org_type', direction: (params[:sort] == 'org_type' && params[:direction] == 'asc') ? 'desc' : 'asc' } %></th>
    <th>User Count</th>
    <th>Total Donations</th>
    <th>Actions</th>
  </tr>
  <% @groups.each do |group| %>
    <tr>
      <td style="text-align: center;"><%= group.name %></td>
      <td style="text-align: center;"><%= group.org_type %></td>
      <td style="text-align: center;"><%= group.calculate_user_count %></td>
      <td style="text-align: center;"><%= number_to_currency(group.calculate_total_donations, unit: '$', precision: 2) %></td>
      <td style="text-align: center;">
        <%= link_to "Show", group_path(group), class: 'action show' %>
        <%= link_to "Edit", edit_group_path(group), class: 'action edit'  %>
        <%= link_to "Delete", delete_group_path(group), class: 'action delete' %>
      </td>
    </tr>
  <% end %>
</table>

<%= link_to "New Group", new_group_path %>
